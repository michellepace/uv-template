repos:
  - repo: https://github.com/astral-sh/uv-pre-commit
    rev: 0.9.8
    hooks:
      - id: uv-lock

  - repo: https://github.com/kynan/nbstripout
    rev: 0.8.1
    hooks:
      # Strip Jupyter notebook outputs (normalize notebooks before code checks)
      - id: nbstripout

  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.14.4
    hooks:
      # Run the formatter
      - id: ruff-format
      # Run the linter
      - id: ruff-check
        args: [--fix, --exit-non-zero-on-fix]

  - repo: https://github.com/RobertCraigie/pyright-python
    rev: v1.1.407
    hooks:
      # Type checking
      - id: pyright

  - repo: local
    hooks:
      # Run all tests
      - id: pytest
        name: pytest
        entry: uv run pytest
        language: system
        types: [python]
        pass_filenames: false

# Notes:
# 1. `uv-lock` hook automatically updates the lockfile to ensure it matches specs in pyproject.toml
# 2. `nbstripout` normalizes notebooks FIRST (before code quality checks)
# 3. `ruff-format` runs before `ruff-check` (format then lint)
# 4. `--exit-non-zero-on-fix` flag blocks commits when ruff makes automatic fixes, must review first
# 5. `pyright` runs type checking to catch type errors before commits
# 6. `pass_filenames: false` makes pytest run all tests rather than only testing modified files
